# This example demonstrates the use of a git repo as a hard-wired input artifact.
# The argo repo is cloned to its target destination at '/src' for the main container to consume.
apiVersion: argoproj.io/v1alpha1
kind: WorkflowTemplate
metadata:
  name: minio
spec:
  entrypoint: install
  arguments:
    parameters:
    - name: destName
    - name: appRevision
    - name: rootAccessKey
    - name: rootSecretKey
  templates:  
    - name: install
      inputs:
        parameters:
        #- name: destName
        #- name: appRevision
        - name: rootAccessKey
          value: "{{inputs.parameters.rootAccessKey}}"
        - name: rootSecretKey
          value: "{{inputs.parameters.rootSecretKey}}"
        - name: appName
          value: "seed-minio"
        - name: appPath
          value: "charts/argocd-minio/"
        - name: "releaseName"
          value: "minio"
        - name: "destName"
          value: "{{inputs.parameters.destName}}"
        - name: "appRevision"
          value: "{{inputs.parameters.appRevision}}"       
      steps:
      - - name: mini
          arguments:
            parameters:
              - name: appName
                value: "{{inputs.parameters.appName}}"
              #  value: "seed-minio"
              - name: appPath
                value: "{{inputs.parameters.appPath}}"
              #  value: "charts/argocd-minio/"
              - name: "releaseName"
                value: "{{inputs.parameters.releaseName}}"
              #  value: "minio"
              - name: "destName"
                value: "{{inputs.parameters.destName}}"              
              #  value: "{{inputs.parameters.destName}}"
              - name: "appRevision"
                value: "{{inputs.parameters.appRevision}}"
              #  value: "{{inputs.parameters.appRevision}}"

              #  value: minio
              - name: "appCreateExtraArgs"
                value: "--helm-set accessKey={{inputs.parameters.rootAccessKey}} --helm-set secretKey={{inputs.parameters.rootSecretKey}}"        
          templateRef:
             name: app-create
             template: install  
